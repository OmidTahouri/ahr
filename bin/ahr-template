#!/bin/bash

BASEDIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
. $BASEDIR/ahr-lib.sh


function show_help(){
    echo "Generate overrides based on template file by resolving environment variabls"
    echo ""
    echo "Usage:"
    echo "    ahr-template <template-file>"
    echo ""
}
if [ "$#" -lt 1 ]; then
    show_help
    exit 5
fi

TEMPLATE="$1"



# check required variables
check_envvars "PROJECT CLUSTER ORG ENV"

check_envvars "ENC_KEY_KMS ENC_KEY_KVM ENC_KEY_CACHE"

check_envvars "SYNCHRONIZER_SA UDCA_SA MART_SA METRICS_SA"

check_envvars "RUNTIME_HOST_ALIAS RUNTIME_SSL_CERT RUNTIME_SSL_KEY RUNTIME_IP"
check_envvars "MART_HOST_ALIAS MART_SSL_CERT MART_SSL_KEY MART_IP"

envsubst < $TEMPLATE
